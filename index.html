<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#6366f1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Expense Tracker">
<link rel="apple-touch-icon" href="icon.png">


    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Expense Tracker - BDT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --gray-light: #e2e8f0;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
        }
        .dark-mode {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            color: #e2e8f0;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: var(--shadow);
        }
        .dark-mode .glass-effect {
            background: rgba(30, 41, 59, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        .dark-mode .card {
            background: #2d3748;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .btn {
            border-radius: 12px;
            padding: 12px 24px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }
        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: white;
        }
        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
            color: white;
        }
        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
            color: white;
        }
        .btn-purple {
            background: linear-gradient(135deg, var(--secondary) 0%, #7c3aed 100%);
            color: white;
        }
        .btn-orange {
            background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
            color: white;
        }
        .icon-box {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .icon-box-success {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            color: var(--success);
        }
        .icon-box-danger {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            color: var(--danger);
        }
        .icon-box-warning {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            color: var(--warning);
        }
        .icon-box-info {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            color: var(--info);
        }
        .icon-box-purple {
            background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);
            color: var(--secondary);
        }
        .icon-box-orange {
            background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%);
            color: #f97316;
        }
        .stat-card {
            padding: 24px;
            border-radius: 16px;
            background: white;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }
        .dark-mode .stat-card {
            background: #2d3748;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .tab-btn {
            padding: 12px 24px;
            border-radius: 12px 12px 0 0;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            background: transparent;
            color: var(--gray);
            cursor: pointer;
        }
        .tab-btn.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
        }
        .dark-mode .tab-btn.active {
            background: #2d3748;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideIn 0.3s ease;
        }
        .dark-mode .modal-content {
            background: #2d3748;
        }
        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--gray-light);
        }
        .dark-mode .modal-header {
            border-color: #4a5568;
        }
        .modal-body {
            padding: 24px;
        }
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        .dark-mode .modal-footer {
            border-color: #4a5568;
        }
        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        .dark-mode .form-control {
            background: #374151;
            border-color: #4a5568;
            color: #e2e8f0;
        }
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        .category-btn {
            padding: 16px;
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            background: white;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 12px;
        }
        .dark-mode .category-btn {
            background: #374151;
            border-color: #4a5568;
        }
        .category-btn:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        .category-btn.selected {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary);
        }
        .transaction-item {
            padding: 16px;
            border-radius: 12px;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }
        .dark-mode .transaction-item {
            background: #374151;
        }
        .transaction-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            padding: 16px 24px;
            border-radius: 12px;
            background: white;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 2000;
        }
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        .toast.success {
            border-left: 4px solid var(--success);
        }
        .toast.error {
            border-left: 4px solid var(--danger);
        }
        .toast.info {
            border-left: 4px solid var(--info);
        }
        .dark-mode .toast {
            background: #2d3748;
        }
        .chart-container {
            position: relative;
            height: 300px;
            padding: 20px;
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
        }
        .dark-mode .chart-container {
            background: #2d3748;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-up {
            animation: slideUp 0.5s ease forwards;
        }
        
        /* Dark mode fixes and glowing text effects */
        .dark-mode .bg-white {
            background-color: #2d3748;
        }
        .dark-mode .text-gray-700 {
            color: #e2e8f0;
        }
        .dark-mode .text-gray-600 {
            color: #cbd5e0;
        }
        .dark-mode .border-gray-200 {
            border-color: #4a5568;
        }
        .dark-mode .bg-gray-50 {
            background-color: #2d3748;
        }
        .dark-mode .hover\:bg-gray-100:hover {
            background-color: #4a5568;
        }
        
        /* Dark mode text visibility improvements with glowing effect */
        .dark-mode h1, 
        .dark-mode h2, 
        .dark-mode h3, 
        .dark-mode h4, 
        .dark-mode h5, 
        .dark-mode h6,
        .dark-mode .text-gray-800,
        .dark-mode .font-bold,
        .dark-mode .font-semibold {
            color: #f8fafc !important;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }
        
        .dark-mode .text-gray-600,
        .dark-mode .text-gray-500,
        .dark-mode p,
        .dark-mode span,
        .dark-mode label,
        .dark-mode td,
        .dark-mode th {
            color: #e2e8f0 !important;
            text-shadow: 0 0 3px rgba(255, 255, 255, 0.2);
        }
        
        .dark-mode .text-green-600,
        .dark-mode .text-red-600,
        .dark-mode .text-blue-600,
        .dark-mode .text-purple-600,
        .dark-mode .text-orange-600,
        .dark-mode .text-indigo-600 {
            text-shadow: 0 0 5px currentColor;
        }
        
        /* Dark mode fixes for date inputs */
        .dark-mode input[type="date"] {
            background-color: #374151;
            color: #e2e8f0;
            border-color: #4a5568;
        }
        
        .dark-mode input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }
        
        .dark-mode input[type="date"]::-webkit-inner-spin-button {
            display: none;
        }
        
        .dark-mode input[type="date"]::-webkit-clear-button {
            display: none;
        }
        
        /* Firefox specific */
        .dark-mode input[type="date"]::-moz-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }
        
        /* Dark mode fixes for dropdowns */
        .dark-mode select {
            background-color: #374151;
            color: #e2e8f0;
            border-color: #4a5568;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%23cbd5e0' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }
        
        .dark-mode select option {
            background-color: #2d3748;
            color: #e2e8f0;
        }
        
        .dark-mode select:focus {
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        /* Dark mode fixes for monthly summary sections */
        .dark-mode .bg-green-50 {
            background-color: #1a3a1a !important;
        }
        .dark-mode .bg-red-50 {
            background-color: #3a1a1a !important;
        }
        .dark-mode .bg-blue-50 {
            background-color: #1a2a3a !important;
        }
        .dark-mode .bg-purple-50 {
            background-color: #2a1a3a !important;
        }
        .dark-mode .bg-orange-50 {
            background-color: #3a2a1a !important;
        }
        .dark-mode .bg-indigo-50 {
            background-color: #1a2a4a !important;
        }
        
        .dark-mode .text-green-600 {
            color: #4ade80 !important;
        }
        .dark-mode .text-red-600 {
            color: #f87171 !important;
        }
        .dark-mode .text-blue-600 {
            color: #60a5fa !important;
        }
        .dark-mode .text-purple-600 {
            color: #c084fc !important;
        }
        .dark-mode .text-orange-600 {
            color: #fb923c !important;
        }
        .dark-mode .text-indigo-600 {
            color: #818cf8 !important;
        }
        
        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .dark-mode ::-webkit-scrollbar-track {
            background: #2d3748;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .dark-mode ::-webkit-scrollbar-thumb {
            background: #4a5568;
        }
        
        .dark-mode ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
    </style>
</head>
<body class="min-h-screen transition-colors duration-200">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header -->
        <header class="mb-8">
            <div class="glass-effect rounded-2xl p-6">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">
                            <i class="fas fa-wallet text-indigo-600 mr-3"></i>
                            Personal Expense Tracker
                        </h1>
                        <p class="text-gray-600">Track your income, expenses, assets, and liabilities in BDT (৳)</p>
                    </div>
                    <div class="flex space-x-3">
                        <button id="resetDataBtn" class="p-3 rounded-full bg-red-100 hover:bg-red-200 transition-all duration-300 group" title="Reset All Data">
                            <i class="fas fa-redo-alt text-red-600 group-hover:rotate-180 transition-transform duration-500"></i>
                        </button>
                        <button id="darkModeToggle" class="p-3 rounded-full bg-gray-200 hover:bg-gray-300 transition-all duration-300 group" title="Toggle Dark Mode">
                            <i class="fas fa-moon text-gray-700 group-hover:text-yellow-500 transition-colors"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Navigation Tabs -->
        <div class="mb-8">
            <div class="glass-effect rounded-t-2xl p-1">
                <nav class="flex space-x-1 overflow-x-auto">
                    <button class="tab-btn active" data-tab="dashboard">
                        <i class="fas fa-chart-line mr-2"></i>Dashboard
                    </button>
                    <button class="tab-btn" data-tab="add-transaction">
                        <i class="fas fa-plus-circle mr-2"></i>Add Transaction
                    </button>
                    <button class="tab-btn" data-tab="monthly-summary">
                        <i class="fas fa-calendar-alt mr-2"></i>Monthly Summary
                    </button>
                    <button class="tab-btn" data-tab="history">
                        <i class="fas fa-history mr-2"></i>Transaction History
                    </button>
                    <button class="tab-btn" data-tab="assets-liabilities">
                        <i class="fas fa-hand-holding-usd mr-2"></i>Assets & Liabilities
                    </button>
                </nav>
            </div>
        </div>
        
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content animate-slide-up">
            <!-- Main Financial Overview -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stat-card">
                    <div class="flex items-center">
                        <div class="icon-box icon-box-success">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-gray-600 text-sm font-medium">Total Income</p>
                            <p class="text-2xl font-bold text-gray-800" id="totalIncome">৳0</p>
                            <p class="text-xs text-gray-500">This month</p>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="flex items-center">
                        <div class="icon-box icon-box-danger">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-gray-600 text-sm font-medium">Total Expenses</p>
                            <p class="text-2xl font-bold text-gray-800" id="totalExpenses">৳0</p>
                            <p class="text-xs text-gray-500">This month</p>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="flex items-center">
                        <div class="icon-box icon-box-warning">
                            <i class="fas fa-calendar-day"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-gray-600 text-sm font-medium">Today's Spending</p>
                            <p class="text-2xl font-bold text-gray-800" id="todaySpending">৳0</p>
                            <p class="text-xs text-gray-500">Expenses today</p>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="flex items-center">
                        <div class="icon-box icon-box-info">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-gray-600 text-sm font-medium">Available Balance</p>
                            <p class="text-2xl font-bold text-gray-800" id="currentBalance">৳0</p>
                            <p class="text-xs text-gray-500">Cash in hand</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Assets and Liabilities Overview -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="stat-card">
                    <div class="flex items-center">
                        <div class="icon-box icon-box-purple">
                            <i class="fas fa-hand-holding-usd"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-gray-600 text-sm font-medium">Money I Will Receive</p>
                            <p class="text-2xl font-bold text-gray-800" id="moneyWillReceive">৳0</p>
                            <p class="text-xs text-gray-500">Assets (money lent out)</p>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="flex items-center">
                        <div class="icon-box icon-box-orange">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-gray-600 text-sm font-medium">Money I Have to Give</p>
                            <p class="text-2xl font-bold text-gray-800" id="moneyHaveToGive">৳0</p>
                            <p class="text-xs text-gray-500">Liabilities (money borrowed)</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chart-container mb-8">
                <h2 class="text-xl font-bold mb-4 text-gray-800">Daily Expenses - Current Month</h2>
                <canvas id="dailyExpensesChart"></canvas>
            </div>
        </div>
        
        <!-- Add Transaction Tab -->
        <div id="add-transaction" class="tab-content hidden">
            <div class="glass-effect rounded-2xl p-8 mb-8">
                <h2 class="text-2xl font-bold mb-8 text-center text-gray-800">Add New Transaction</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <button id="incomeBtn" class="btn btn-success h-48 flex flex-col items-center justify-center transform hover:scale-105 transition-all duration-300">
                        <i class="fas fa-arrow-down text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold">Income</h3>
                        <p class="mt-2 text-sm opacity-90">Add money received</p>
                    </button>
                    
                    <button id="expenseBtn" class="btn btn-danger h-48 flex flex-col items-center justify-center transform hover:scale-105 transition-all duration-300">
                        <i class="fas fa-arrow-up text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold">Expense</h3>
                        <p class="mt-2 text-sm opacity-90">Add money spent</p>
                    </button>
                    
                    <button id="assetBtn" class="btn btn-purple h-48 flex flex-col items-center justify-center transform hover:scale-105 transition-all duration-300">
                        <i class="fas fa-hand-holding-usd text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold">Asset</h3>
                        <p class="mt-2 text-sm opacity-90">Money lent to others</p>
                    </button>
                    
                    <button id="liabilityBtn" class="btn btn-orange h-48 flex flex-col items-center justify-center transform hover:scale-105 transition-all duration-300">
                        <i class="fas fa-credit-card text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold">Liability</h3>
                        <p class="mt-2 text-sm opacity-90">Money borrowed</p>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Monthly Summary Tab -->
        <div id="monthly-summary" class="tab-content hidden">
            <div class="glass-effect rounded-2xl p-8 mb-8">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">Monthly Summary</h2>
                    <div class="mt-4 md:mt-0">
                        <label class="block text-gray-700 mb-2 font-medium" for="monthSelector">Select Month</label>
                        <input type="month" id="monthSelector" class="form-control">
                    </div>
                </div>
                
                <!-- Main Financial Summary -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="stat-card">
                        <div class="text-center">
                            <p class="text-gray-600 text-sm font-medium mb-2">Total Income</p>
                            <p class="text-3xl font-bold text-green-600" id="monthlyIncome">৳0</p>
                            <p class="text-xs text-gray-500 mt-1">This month</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="text-center">
                            <p class="text-gray-600 text-sm font-medium mb-2">Total Expenses</p>
                            <p class="text-3xl font-bold text-red-600" id="monthlyExpenses">৳0</p>
                            <p class="text-xs text-gray-500 mt-1">This month</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="text-center">
                            <p class="text-gray-600 text-sm font-medium mb-2">Regular Cash Flow</p>
                            <p class="text-3xl font-bold text-blue-600" id="monthlyCashFlow">৳0</p>
                            <p class="text-xs text-gray-500 mt-1">Income - Expenses</p>
                        </div>
                    </div>
                </div>
                
                <!-- Available Balance -->
                <div class="stat-card mb-8">
                    <div class="text-center">
                        <p class="text-gray-600 text-sm font-medium mb-2">Available Balance</p>
                        <p class="text-3xl font-bold text-indigo-600" id="monthlyBalance">৳0</p>
                        <p class="text-xs text-gray-500 mt-1">Cash in hand</p>
                    </div>
                </div>
                
                <!-- Assets and Liabilities Summary -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="stat-card">
                        <div class="text-center">
                            <p class="text-gray-600 text-sm font-medium mb-2">Money I Will Receive</p>
                            <p class="text-3xl font-bold text-purple-600" id="monthlyMoneyWillReceive">৳0</p>
                            <p class="text-xs text-gray-500 mt-1">Assets (money lent out)</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="text-center">
                            <p class="text-gray-600 text-sm font-medium mb-2">Money I Have to Give</p>
                            <p class="text-3xl font-bold text-orange-600" id="monthlyMoneyHaveToGive">৳0</p>
                            <p class="text-xs text-gray-500 mt-1">Liabilities (money borrowed)</p>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="categoryPieChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Transaction History Tab -->
        <div id="history" class="tab-content hidden">
            <div class="glass-effect rounded-2xl p-8 mb-8">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">Transaction History</h2>
                    <div class="mt-4 md:mt-0 flex space-x-3">
                        <button id="exportCsv" class="btn btn-success">
                            <i class="fas fa-file-csv mr-2"></i>Export CSV
                        </button>
                        <button id="exportPdf" class="btn btn-danger">
                            <i class="fas fa-file-pdf mr-2"></i>Export PDF
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div>
                        <label class="block text-gray-700 mb-2 font-medium" for="filterType">Filter by Type</label>
                        <select id="filterType" class="form-control">
                            <option value="">All Types</option>
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2 font-medium" for="filterCategory">Filter by Category</label>
                        <select id="filterCategory" class="form-control">
                            <option value="">All Categories</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2 font-medium" for="filterStartDate">Start Date</label>
                        <input type="date" id="filterStartDate" class="form-control">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2 font-medium" for="filterEndDate">End Date</label>
                        <input type="date" id="filterEndDate" class="form-control">
                    </div>
                </div>
                
                <div class="mb-6">
                    <button id="applyFilters" class="btn btn-primary mr-3">
                        <i class="fas fa-filter mr-2"></i>Apply Filters
                    </button>
                    <button id="clearFilters" class="btn" style="background: #6b7280; color: white;">
                        <i class="fas fa-times mr-2"></i>Clear Filters
                    </button>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer" id="sortDate">
                                    Date <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer" id="sortAmount">
                                    Amount <i class="fas fa-sort ml-1"></i>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Notes</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="transactionTableBody">
                            <tr>
                                <td colspan="5" class="px-6 py-4 text-center text-gray-500">No transactions found</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Assets & Liabilities Tab -->
        <div id="assets-liabilities" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Assets Section -->
                <div class="glass-effect rounded-2xl p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-purple-600">Assets (Money I Will Receive)</h2>
                        <span class="text-lg font-semibold bg-purple-100 text-purple-800 px-3 py-1 rounded-full" id="totalAssetsAmount">৳0</span>
                    </div>
                    
                    <div class="mb-6 bg-purple-50 rounded-lg p-4">
                        <div class="flex justify-between text-sm text-gray-600 mb-1">
                            <span>Total Lent:</span>
                            <span id="totalLent">৳0</span>
                        </div>
                        <div class="flex justify-between text-sm text-gray-600">
                            <span>Total Received:</span>
                            <span id="totalReceived">৳0</span>
                        </div>
                    </div>
                    
                    <div class="space-y-4 max-h-96 overflow-y-auto pr-2" id="assetsList">
                        <p class="text-gray-500 text-center py-4">No assets found</p>
                    </div>
                </div>
                
                <!-- Liabilities Section -->
                <div class="glass-effect rounded-2xl p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-orange-600">Liabilities (Money I Have to Give)</h2>
                        <span class="text-lg font-semibold bg-orange-100 text-orange-800 px-3 py-1 rounded-full" id="totalLiabilitiesAmount">৳0</span>
                    </div>
                    
                    <div class="mb-6 bg-orange-50 rounded-lg p-4">
                        <div class="flex justify-between text-sm text-gray-600 mb-1">
                            <span>Total Borrowed:</span>
                            <span id="totalBorrowed">৳0</span>
                        </div>
                        <div class="flex justify-between text-sm text-gray-600">
                            <span>Total Returned:</span>
                            <span id="totalReturned">৳0</span>
                        </div>
                    </div>
                    
                    <div class="space-y-4 max-h-96 overflow-y-auto pr-2" id="liabilitiesList">
                        <p class="text-gray-500 text-center py-4">No liabilities found</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Transaction Modal -->
    <div id="transactionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="text-xl font-bold" id="modalTitle">Add Transaction</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="modalTransactionForm">
                <div class="modal-body">
                    <input type="hidden" id="modalType">
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="modalAmount">Amount (BDT)</label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-500">৳</span>
                            <input type="number" id="modalAmount" class="form-control pl-8" placeholder="0.00" step="0.01" required>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium">Category</label>
                        <div class="grid grid-cols-2 gap-2" id="categoryGrid">
                            <!-- Categories will be dynamically inserted here -->
                        </div>
                    </div>
                    
                    <div class="mb-4" id="customCategoryInput" style="display: none;">
                        <label class="block text-gray-700 mb-2 font-medium" for="customCategoryName">Custom Category Name</label>
                        <input type="text" id="customCategoryName" class="form-control" placeholder="Enter custom category name">
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="modalDate">Date</label>
                        <input type="date" id="modalDate" class="form-control" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-2 font-medium" for="modalNotes">Notes (Optional)</label>
                        <textarea id="modalNotes" class="form-control" rows="3" placeholder="Add any additional notes..."></textarea>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" id="cancelBtn" class="btn" style="background: #6b7280; color: white;">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save mr-2"></i>Save Transaction
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Asset Modal -->
    <div id="assetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="text-xl font-bold text-purple-600">Add Asset</h3>
                <button id="closeAssetModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="assetForm">
                <div class="modal-body">
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="assetAmount">Amount (BDT)</label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-500">৳</span>
                            <input type="number" id="assetAmount" class="form-control pl-8" placeholder="0.00" step="0.01" required>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="borrowerName">Borrower's Name</label>
                        <input type="text" id="borrowerName" class="form-control" placeholder="Who borrowed the money" required>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="assetDate">Date Given</label>
                        <input type="date" id="assetDate" class="form-control" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-2 font-medium" for="assetNotes">Notes (Optional)</label>
                        <textarea id="assetNotes" class="form-control" rows="3" placeholder="Add any additional notes..."></textarea>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" id="cancelAssetBtn" class="btn" style="background: #6b7280; color: white;">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-purple">
                        <i class="fas fa-save mr-2"></i>Save Asset
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Liability Modal -->
    <div id="liabilityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="text-xl font-bold text-orange-600">Add Liability</h3>
                <button id="closeLiabilityModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="liabilityForm">
                <div class="modal-body">
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="liabilityAmount">Amount (BDT)</label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-500">৳</span>
                            <input type="number" id="liabilityAmount" class="form-control pl-8" placeholder="0.00" step="0.01" required>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="lenderName">Lender's Name</label>
                        <input type="text" id="lenderName" class="form-control" placeholder="Who you borrowed from" required>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="liabilityDate">Date Taken</label>
                        <input type="date" id="liabilityDate" class="form-control" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-2 font-medium" for="liabilityNotes">Notes (Optional)</label>
                        <textarea id="liabilityNotes" class="form-control" rows="3" placeholder="Add any additional notes..."></textarea>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" id="cancelLiabilityBtn" class="btn" style="background: #6b7280; color: white;">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-orange">
                        <i class="fas fa-save mr-2"></i>Save Liability
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Repayment Modal -->
    <div id="repaymentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="text-xl font-bold text-purple-600">Add Repayment</h3>
                <button id="closeRepaymentModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="repaymentForm">
                <div class="modal-body">
                    <input type="hidden" id="repaymentAssetId">
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="repaymentAmount">Amount Received (BDT)</label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-500">৳</span>
                            <input type="number" id="repaymentAmount" class="form-control pl-8" placeholder="0.00" step="0.01" required>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="repaymentDate">Date Received</label>
                        <input type="date" id="repaymentDate" class="form-control" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-2 font-medium" for="repaymentNotes">Notes (Optional)</label>
                        <textarea id="repaymentNotes" class="form-control" rows="3" placeholder="Add any additional notes..."></textarea>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" id="cancelRepaymentBtn" class="btn" style="background: #6b7280; color: white;">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-purple">
                        <i class="fas fa-save mr-2"></i>Save Repayment
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Return Modal -->
    <div id="returnModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="text-xl font-bold text-orange-600">Add Return</h3>
                <button id="closeReturnModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="returnForm">
                <div class="modal-body">
                    <input type="hidden" id="returnLiabilityId">
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="returnAmount">Amount Returned (BDT)</label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-500">৳</span>
                            <input type="number" id="returnAmount" class="form-control pl-8" placeholder="0.00" step="0.01" required>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2 font-medium" for="returnDate">Date Returned</label>
                        <input type="date" id="returnDate" class="form-control" required>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-2 font-medium" for="returnNotes">Notes (Optional)</label>
                        <textarea id="returnNotes" class="form-control" rows="3" placeholder="Add any additional notes..."></textarea>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" id="cancelReturnBtn" class="btn" style="background: #6b7280; color: white;">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-orange">
                        <i class="fas fa-save mr-2"></i>Save Return
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Reset Confirmation Modal -->
    <div id="resetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="text-xl font-bold text-red-600">Reset All Data</h3>
                <button id="closeResetModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <p class="text-gray-700 mb-4">Are you sure you want to reset all data? This action will:</p>
                <ul class="list-disc pl-5 text-gray-600 space-y-1">
                    <li>Delete all transactions</li>
                    <li>Delete all assets and liabilities</li>
                    <li>Reset all amounts to zero</li>
                    <li>This action cannot be undone</li>
                </ul>
            </div>
            
            <div class="modal-footer">
                <button type="button" id="cancelResetBtn" class="btn" style="background: #6b7280; color: white;">
                    Cancel
                </button>
                <button type="button" id="confirmResetBtn" class="btn btn-danger">
                    <i class="fas fa-trash-alt mr-2"></i>Reset All Data
                </button>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <div class="flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            <span id="toastMessage">Transaction saved successfully!</span>
        </div>
    </div>
    
    <script>
        // Initialize data structure
        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        let assets = JSON.parse(localStorage.getItem('assets')) || [];
        let liabilities = JSON.parse(localStorage.getItem('liabilities')) || [];
        let dailyExpensesChart = null;
        let categoryPieChart = null;
        let sortOrder = { date: 'desc', amount: 'desc' };
        let selectedCategory = null;
        
        // Category configurations with icons and colors
        const categoryConfig = {
            // Income categories
            'Salary': { icon: 'fa-briefcase', color: 'bg-green-100 border-green-300 text-green-700', darkColor: 'bg-green-800 border-green-600 text-green-200' },
            'Freelance': { icon: 'fa-laptop', color: 'bg-blue-100 border-blue-300 text-blue-700', darkColor: 'bg-blue-800 border-blue-600 text-blue-200' },
            'Gift': { icon: 'fa-gift', color: 'bg-pink-100 border-pink-300 text-pink-700', darkColor: 'bg-pink-800 border-pink-600 text-pink-200' },
            'Sale': { icon: 'fa-shopping-cart', color: 'bg-yellow-100 border-yellow-300 text-yellow-700', darkColor: 'bg-yellow-800 border-yellow-600 text-yellow-200' },
            'Allowance': { icon: 'fa-piggy-bank', color: 'bg-purple-100 border-purple-300 text-purple-700', darkColor: 'bg-purple-800 border-purple-600 text-purple-200' },
            'Other': { icon: 'fa-ellipsis-h', color: 'bg-gray-100 border-gray-300 text-gray-700', darkColor: 'bg-gray-800 border-gray-600 text-gray-200' },
            
            // Expense categories
            'Food': { icon: 'fa-utensils', color: 'bg-red-100 border-red-300 text-red-700', darkColor: 'bg-red-800 border-red-600 text-red-200' },
            'Rent': { icon: 'fa-home', color: 'bg-blue-100 border-blue-300 text-blue-700', darkColor: 'bg-blue-800 border-blue-600 text-blue-200' },
            'Transport': { icon: 'fa-car', color: 'bg-yellow-100 border-yellow-300 text-yellow-700', darkColor: 'bg-yellow-800 border-yellow-600 text-yellow-200' },
            'Groceries': { icon: 'fa-shopping-basket', color: 'bg-green-100 border-green-300 text-green-700', darkColor: 'bg-green-800 border-green-600 text-green-200' },
            'Education': { icon: 'fa-graduation-cap', color: 'bg-purple-100 border-purple-300 text-purple-700', darkColor: 'bg-purple-800 border-purple-600 text-purple-200' },
            'Utilities': { icon: 'fa-bolt', color: 'bg-orange-100 border-orange-300 text-orange-700', darkColor: 'bg-orange-800 border-orange-600 text-orange-200' },
            'Mobile Recharge': { icon: 'fa-mobile-alt', color: 'bg-teal-100 border-teal-300 text-teal-700', darkColor: 'bg-teal-800 border-teal-600 text-teal-200' },
            'Entertainment': { icon: 'fa-film', color: 'bg-pink-100 border-pink-300 text-pink-700', darkColor: 'bg-pink-800 border-pink-600 text-pink-200' },
            'Health': { icon: 'fa-heartbeat', color: 'bg-red-100 border-red-300 text-red-700', darkColor: 'bg-red-800 border-red-600 text-red-200' },
            'Other': { icon: 'fa-ellipsis-h', color: 'bg-gray-100 border-gray-300 text-gray-700', darkColor: 'bg-gray-800 border-gray-600 text-gray-200' }
        };
        
        // Categories
        const incomeCategories = ['Salary', 'Freelance', 'Gift', 'Sale', 'Allowance', 'Other'];
        const expenseCategories = ['Food', 'Rent', 'Transport', 'Groceries', 'Education', 'Utilities', 'Mobile Recharge', 'Entertainment', 'Health', 'Other'];
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('modalDate').value = today;
            document.getElementById('assetDate').value = today;
            document.getElementById('liabilityDate').value = today;
            document.getElementById('repaymentDate').value = today;
            document.getElementById('returnDate').value = today;
            
            // Set current month in month selector
            const currentMonth = new Date().toISOString().slice(0, 7);
            document.getElementById('monthSelector').value = currentMonth;
            
            // Modal buttons
            document.getElementById('incomeBtn').addEventListener('click', () => openModal('income'));
            document.getElementById('expenseBtn').addEventListener('click', () => openModal('expense'));
            document.getElementById('assetBtn').addEventListener('click', openAssetModal);
            document.getElementById('liabilityBtn').addEventListener('click', openLiabilityModal);
            
            document.getElementById('closeModal').addEventListener('click', closeModal);
            document.getElementById('cancelBtn').addEventListener('click', closeModal);
            
            document.getElementById('closeAssetModal').addEventListener('click', closeAssetModal);
            document.getElementById('cancelAssetBtn').addEventListener('click', closeAssetModal);
            
            document.getElementById('closeLiabilityModal').addEventListener('click', closeLiabilityModal);
            document.getElementById('cancelLiabilityBtn').addEventListener('click', closeLiabilityModal);
            
            document.getElementById('closeRepaymentModal').addEventListener('click', closeRepaymentModal);
            document.getElementById('cancelRepaymentBtn').addEventListener('click', closeRepaymentModal);
            
            document.getElementById('closeReturnModal').addEventListener('click', closeReturnModal);
            document.getElementById('cancelReturnBtn').addEventListener('click', closeReturnModal);
            
            // Reset modal buttons
            document.getElementById('resetDataBtn').addEventListener('click', openResetModal);
            document.getElementById('closeResetModal').addEventListener('click', closeResetModal);
            document.getElementById('cancelResetBtn').addEventListener('click', closeResetModal);
            document.getElementById('confirmResetBtn').addEventListener('click', resetAllData);
            
            // Modal form submissions
            document.getElementById('modalTransactionForm').addEventListener('submit', handleModalFormSubmit);
            document.getElementById('assetForm').addEventListener('submit', handleAssetFormSubmit);
            document.getElementById('liabilityForm').addEventListener('submit', handleLiabilityFormSubmit);
            document.getElementById('repaymentForm').addEventListener('submit', handleRepaymentFormSubmit);
            document.getElementById('returnForm').addEventListener('submit', handleReturnFormSubmit);
            
            // Tab navigation
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => switchTab(btn.dataset.tab));
            });
            
            // Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);
            
            // Month selector change
            document.getElementById('monthSelector').addEventListener('change', updateMonthlySummary);
            
            // Filter and sort
            document.getElementById('applyFilters').addEventListener('click', applyFilters);
            document.getElementById('clearFilters').addEventListener('click', clearFilters);
            document.getElementById('sortDate').addEventListener('click', () => sortTransactions('date'));
            document.getElementById('sortAmount').addEventListener('click', () => sortTransactions('amount'));
            
            // Export buttons
            document.getElementById('exportCsv').addEventListener('click', exportToCsv);
            document.getElementById('exportPdf').addEventListener('click', exportToPdf);
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === document.getElementById('transactionModal')) {
                    closeModal();
                }
                if (e.target === document.getElementById('assetModal')) {
                    closeAssetModal();
                }
                if (e.target === document.getElementById('liabilityModal')) {
                    closeLiabilityModal();
                }
                if (e.target === document.getElementById('repaymentModal')) {
                    closeRepaymentModal();
                }
                if (e.target === document.getElementById('returnModal')) {
                    closeReturnModal();
                }
                if (e.target === document.getElementById('resetModal')) {
                    closeResetModal();
                }
            });
            
            // Initial load
            updateDashboard();
            updateMonthlySummary();
            updateTransactionHistory();
            updateCategoryOptions();
            updateAssetsList();
            updateLiabilitiesList();
        });
        
        // Open modal with transaction type
        function openModal(type) {
            const modal = document.getElementById('transactionModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalType = document.getElementById('modalType');
            const categoryGrid = document.getElementById('categoryGrid');
            const customCategoryInput = document.getElementById('customCategoryInput');
            
            // Set modal title and type
            modalTitle.textContent = `Add ${type.charAt(0).toUpperCase() + type.slice(1)}`;
            modalType.value = type;
            
            // Clear previous categories and hide custom input
            categoryGrid.innerHTML = '';
            selectedCategory = null;
            customCategoryInput.style.display = 'none';
            document.getElementById('customCategoryName').value = '';
            
            // Add category buttons
            const categories = type === 'income' ? incomeCategories : expenseCategories;
            categories.forEach(category => {
                const config = categoryConfig[category];
                const button = document.createElement('button');
                button.type = 'button';
                button.className = 'category-btn';
                
                // Create button content with icon
                button.innerHTML = `
                    <i class="fas ${config.icon} text-lg mb-1"></i>
                    <div>${category}</div>
                `;
                
                button.addEventListener('click', () => selectCategory(button, category));
                categoryGrid.appendChild(button);
            });
            
            // Show modal
            modal.classList.add('show');
        }
        
        // Open asset modal
        function openAssetModal() {
            const modal = document.getElementById('assetModal');
            modal.classList.add('show');
        }
        
        // Open liability modal
        function openLiabilityModal() {
            const modal = document.getElementById('liabilityModal');
            modal.classList.add('show');
        }
        
        // Open repayment modal
        function openRepaymentModal(assetId) {
            const modal = document.getElementById('repaymentModal');
            document.getElementById('repaymentAssetId').value = assetId;
            modal.classList.add('show');
        }
        
        // Open return modal
        function openReturnModal(liabilityId) {
            const modal = document.getElementById('returnModal');
            document.getElementById('returnLiabilityId').value = liabilityId;
            modal.classList.add('show');
        }
        
        // Open reset modal
        function openResetModal() {
            const modal = document.getElementById('resetModal');
            modal.classList.add('show');
        }
        
        // Select category
        function selectCategory(button, category) {
            // Remove selected class from all buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Add selected class to clicked button
            button.classList.add('selected');
            selectedCategory = category;
            
            // Show/hide custom category input
            const customCategoryInput = document.getElementById('customCategoryInput');
            if (category === 'Other') {
                customCategoryInput.style.display = 'block';
                document.getElementById('customCategoryName').focus();
            } else {
                customCategoryInput.style.display = 'none';
                document.getElementById('customCategoryName').value = '';
            }
        }
        
        // Close modal
        function closeModal() {
            const modal = document.getElementById('transactionModal');
            modal.classList.remove('show');
            
            // Reset form
            document.getElementById('modalTransactionForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('modalDate').value = today;
            selectedCategory = null;
            document.getElementById('customCategoryInput').style.display = 'none';
        }
        
        // Close asset modal
        function closeAssetModal() {
            const modal = document.getElementById('assetModal');
            modal.classList.remove('show');
            
            // Reset form
            document.getElementById('assetForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('assetDate').value = today;
        }
        
        // Close liability modal
        function closeLiabilityModal() {
            const modal = document.getElementById('liabilityModal');
            modal.classList.remove('show');
            
            // Reset form
            document.getElementById('liabilityForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('liabilityDate').value = today;
        }
        
        // Close repayment modal
        function closeRepaymentModal() {
            const modal = document.getElementById('repaymentModal');
            modal.classList.remove('show');
            
            // Reset form
            document.getElementById('repaymentForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('repaymentDate').value = today;
        }
        
        // Close return modal
        function closeReturnModal() {
            const modal = document.getElementById('returnModal');
            modal.classList.remove('show');
            
            // Reset form
            document.getElementById('returnForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('returnDate').value = today;
        }
        
        // Close reset modal
        function closeResetModal() {
            const modal = document.getElementById('resetModal');
            modal.classList.remove('show');
        }
        
        // Reset all data
        function resetAllData() {
            // Clear localStorage
            localStorage.removeItem('transactions');
            localStorage.removeItem('assets');
            localStorage.removeItem('liabilities');
            
            // Reset data arrays
            transactions = [];
            assets = [];
            liabilities = [];
            
            // Close modal
            closeResetModal();
            
            // Update UI
            updateDashboard();
            updateMonthlySummary();
            updateTransactionHistory();
            updateAssetsList();
            updateLiabilitiesList();
            
            // Show toast notification
            showToast('All data has been reset successfully!');
        }
        
        // Handle modal form submission
        function handleModalFormSubmit(e) {
            e.preventDefault();
            
            if (!selectedCategory) {
                showToast('Please select a category!', 'error');
                return;
            }
            
            // If "Other" is selected, validate custom category name
            let finalCategory = selectedCategory;
            if (selectedCategory === 'Other') {
                const customName = document.getElementById('customCategoryName').value.trim();
                if (!customName) {
                    showToast('Please enter a custom category name!', 'error');
                    return;
                }
                finalCategory = customName;
            }
            
            const transaction = {
                id: Date.now(),
                amount: parseFloat(document.getElementById('modalAmount').value),
                type: document.getElementById('modalType').value,
                category: finalCategory,
                date: document.getElementById('modalDate').value,
                notes: document.getElementById('modalNotes').value
            };
            
            transactions.push(transaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));
            
            // Close modal
            closeModal();
            
            // Update UI
            updateDashboard();
            updateMonthlySummary();
            updateTransactionHistory();
            
            // Show toast notification
            showToast('Transaction saved successfully!');
        }
        
        // Handle asset form submission
        function handleAssetFormSubmit(e) {
            e.preventDefault();
            
            const asset = {
                id: Date.now(),
                amount: parseFloat(document.getElementById('assetAmount').value),
                borrowerName: document.getElementById('borrowerName').value,
                dateGiven: document.getElementById('assetDate').value,
                notes: document.getElementById('assetNotes').value,
                repayments: []
            };
            
            assets.push(asset);
            localStorage.setItem('assets', JSON.stringify(assets));
            
            // Close modal
            closeAssetModal();
            
            // Update UI
            updateDashboard();
            updateMonthlySummary();
            updateAssetsList();
            
            // Show toast notification
            showToast('Asset saved successfully!');
        }
        
        // Handle liability form submission
        function handleLiabilityFormSubmit(e) {
            e.preventDefault();
            
            const liability = {
                id: Date.now(),
                amount: parseFloat(document.getElementById('liabilityAmount').value),
                lenderName: document.getElementById('lenderName').value,
                dateTaken: document.getElementById('liabilityDate').value,
                notes: document.getElementById('liabilityNotes').value,
                returns: []
            };
            
            liabilities.push(liability);
            localStorage.setItem('liabilities', JSON.stringify(liabilities));
            
            // Close modal
            closeLiabilityModal();
            
            // Update UI
            updateDashboard();
            updateMonthlySummary();
            updateLiabilitiesList();
            
            // Show toast notification
            showToast('Liability saved successfully!');
        }
        
        // Handle repayment form submission
        function handleRepaymentFormSubmit(e) {
            e.preventDefault();
            
            const assetId = parseInt(document.getElementById('repaymentAssetId').value);
            const assetIndex = assets.findIndex(a => a.id === assetId);
            
            if (assetIndex === -1) {
                showToast('Asset not found!', 'error');
                return;
            }
            
            const repayment = {
                id: Date.now(),
                amount: parseFloat(document.getElementById('repaymentAmount').value),
                dateReceived: document.getElementById('repaymentDate').value,
                notes: document.getElementById('repaymentNotes').value
            };
            
            assets[assetIndex].repayments.push(repayment);
            localStorage.setItem('assets', JSON.stringify(assets));
            
            // Close modal
            closeRepaymentModal();
            
            // Update UI
            updateDashboard();
            updateMonthlySummary();
            updateAssetsList();
            
            // Show toast notification
            showToast('Repayment saved successfully!');
        }
        
        // Handle return form submission
        function handleReturnFormSubmit(e) {
            e.preventDefault();
            
            const liabilityId = parseInt(document.getElementById('returnLiabilityId').value);
            const liabilityIndex = liabilities.findIndex(l => l.id === liabilityId);
            
            if (liabilityIndex === -1) {
                showToast('Liability not found!', 'error');
                return;
            }
            
            const returnPayment = {
                id: Date.now(),
                amount: parseFloat(document.getElementById('returnAmount').value),
                dateReturned: document.getElementById('returnDate').value,
                notes: document.getElementById('returnNotes').value
            };
            
            liabilities[liabilityIndex].returns.push(returnPayment);
            localStorage.setItem('liabilities', JSON.stringify(liabilities));
            
            // Close modal
            closeReturnModal();
            
            // Update UI
            updateDashboard();
            updateMonthlySummary();
            updateLiabilitiesList();
            
            // Show toast notification
            showToast('Return saved successfully!');
        }
        
        // Update category options for filter
        function updateCategoryOptions() {
            const filterCategorySelect = document.getElementById('filterCategory');
            filterCategorySelect.innerHTML = '<option value="">All Categories</option>';
            
            // Add all categories
            const allCategories = [...new Set([...incomeCategories, ...expenseCategories])];
            allCategories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                
                const config = categoryConfig[category];
                if (config) {
                    option.textContent = `${category} (${config.icon.replace('fa-', '').replace('-', ' ')})`;
                } else {
                    option.textContent = category;
                }
                
                filterCategorySelect.appendChild(option);
            });
        }
        
        // Update dashboard
        function updateDashboard() {
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            const today = currentDate.toISOString().split('T')[0];
            
            // Filter transactions for current month
            const currentMonthTransactions = transactions.filter(transaction => {
                const transactionDate = new Date(transaction.date);
                return transactionDate.getMonth() === currentMonth && transactionDate.getFullYear() === currentYear;
            });
            
            // Filter transactions for today
            const todayTransactions = transactions.filter(transaction => transaction.date === today && transaction.type === 'expense');
            
            // Calculate totals
            const totalIncome = currentMonthTransactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
                
            const totalExpenses = currentMonthTransactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
                
            const todaySpending = todayTransactions
                .reduce((sum, t) => sum + t.amount, 0);
            
            // Calculate assets and liabilities
            const totalAssets = assets.reduce((sum, asset) => {
                const totalRepaid = asset.repayments.reduce((repSum, repayment) => repSum + repayment.amount, 0);
                return sum + (asset.amount - totalRepaid);
            }, 0);
                
            const totalLiabilities = liabilities.reduce((sum, liability) => {
                const totalReturned = liability.returns.reduce((retSum, ret) => retSum + ret.amount, 0);
                return sum + (liability.amount - totalReturned);
            }, 0);
            
            // Calculate cash flow from assets and liabilities
            const totalAssetLent = assets.reduce((sum, asset) => sum + asset.amount, 0);
            const totalAssetRepaid = assets.reduce((sum, asset) => {
                return sum + asset.repayments.reduce((repSum, repayment) => repSum + repayment.amount, 0);
            }, 0);
            
            const totalLiabilityBorrowed = liabilities.reduce((sum, liability) => sum + liability.amount, 0);
            const totalLiabilityReturned = liabilities.reduce((sum, liability) => {
                return sum + liability.returns.reduce((retSum, ret) => retSum + ret.amount, 0);
            }, 0);
            
            // Calculate current balance: Income - Expenses + (Liabilities Borrowed - Liabilities Returned) - (Assets Lent - Assets Repaid)
            const currentBalance = (totalIncome - totalExpenses) + 
                                  (totalLiabilityBorrowed - totalLiabilityReturned) - 
                                  (totalAssetLent - totalAssetRepaid);
            
            // Update UI
            document.getElementById('totalIncome').textContent = `৳${totalIncome.toFixed(2)}`;
            document.getElementById('totalExpenses').textContent = `৳${totalExpenses.toFixed(2)}`;
            document.getElementById('todaySpending').textContent = `৳${todaySpending.toFixed(2)}`;
            document.getElementById('currentBalance').textContent = `৳${currentBalance.toFixed(2)}`;
            document.getElementById('moneyWillReceive').textContent = `৳${totalAssets.toFixed(2)}`;
            document.getElementById('moneyHaveToGive').textContent = `৳${totalLiabilities.toFixed(2)}`;
            
            // Update daily expenses chart
            updateDailyExpensesChart(currentMonthTransactions);
        }
        
        // Update daily expenses chart
        function updateDailyExpensesChart(monthTransactions) {
            const ctx = document.getElementById('dailyExpensesChart').getContext('2d');
            
            // Get all days in the current month
            const currentDate = new Date();
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Initialize daily expenses array
            const dailyExpenses = Array(daysInMonth).fill(0);
            
            // Calculate daily expenses
            monthTransactions
                .filter(t => t.type === 'expense')
                .forEach(transaction => {
                    const day = new Date(transaction.date).getDate() - 1; // 0-indexed
                    dailyExpenses[day] += transaction.amount;
                });
            
            // Destroy existing chart if it exists
            if (dailyExpensesChart) {
                dailyExpensesChart.destroy();
            }
            
            // Create new chart
            dailyExpensesChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: daysInMonth}, (_, i) => i + 1),
                    datasets: [{
                        label: 'Daily Expenses (৳)',
                        data: dailyExpenses,
                        backgroundColor: 'rgba(239, 68, 68, 0.5)',
                        borderColor: 'rgba(239, 68, 68, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '৳' + value;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Update monthly summary
        function updateMonthlySummary() {
            const selectedMonth = document.getElementById('monthSelector').value;
            if (!selectedMonth) return;
            
            const [year, month] = selectedMonth.split('-').map(Number);
            
            // Filter transactions for selected month
            const monthTransactions = transactions.filter(transaction => {
                const transactionDate = new Date(transaction.date);
                return transactionDate.getMonth() === month - 1 && transactionDate.getFullYear() === year;
            });
            
            // Calculate totals
            const totalIncome = monthTransactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
                
            const totalExpenses = monthTransactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
                
            // Calculate regular cash flow (Income - Expenses)
            const regularCashFlow = totalIncome - totalExpenses;
            
            // Calculate assets and liabilities
            const totalAssets = assets.reduce((sum, asset) => {
                const totalRepaid = asset.repayments.reduce((repSum, repayment) => repSum + repayment.amount, 0);
                return sum + (asset.amount - totalRepaid);
            }, 0);
                
            const totalLiabilities = liabilities.reduce((sum, liability) => {
                const totalReturned = liability.returns.reduce((retSum, ret) => retSum + ret.amount, 0);
                return sum + (liability.amount - totalReturned);
            }, 0);
            
            // Calculate cash flow from assets and liabilities
            const totalAssetLent = assets.reduce((sum, asset) => sum + asset.amount, 0);
            const totalAssetRepaid = assets.reduce((sum, asset) => {
                return sum + asset.repayments.reduce((repSum, repayment) => repSum + repayment.amount, 0);
            }, 0);
            
            const totalLiabilityBorrowed = liabilities.reduce((sum, liability) => sum + liability.amount, 0);
            const totalLiabilityReturned = liabilities.reduce((sum, liability) => {
                return sum + liability.returns.reduce((retSum, ret) => retSum + ret.amount, 0);
            }, 0);
            
            // Calculate available balance: Income - Expenses + (Liabilities Borrowed - Liabilities Returned) - (Assets Lent - Assets Repaid)
            const availableBalance = (totalIncome - totalExpenses) + 
                                  (totalLiabilityBorrowed - totalLiabilityReturned) - 
                                  (totalAssetLent - totalAssetRepaid);
            
            // Update UI
            document.getElementById('monthlyIncome').textContent = `৳${totalIncome.toFixed(2)}`;
            document.getElementById('monthlyExpenses').textContent = `৳${totalExpenses.toFixed(2)}`;
            document.getElementById('monthlyCashFlow').textContent = `৳${regularCashFlow.toFixed(2)}`;
            document.getElementById('monthlyBalance').textContent = `৳${availableBalance.toFixed(2)}`;
            document.getElementById('monthlyMoneyWillReceive').textContent = `৳${totalAssets.toFixed(2)}`;
            document.getElementById('monthlyMoneyHaveToGive').textContent = `৳${totalLiabilities.toFixed(2)}`;
            
            // Update category pie chart
            updateCategoryPieChart(monthTransactions);
        }
        
        // Update category pie chart
        function updateCategoryPieChart(monthTransactions) {
            const ctx = document.getElementById('categoryPieChart').getContext('2d');
            
            // Calculate expenses by category
            const categoryExpenses = {};
            monthTransactions
                .filter(t => t.type === 'expense')
                .forEach(transaction => {
                    if (!categoryExpenses[transaction.category]) {
                        categoryExpenses[transaction.category] = 0;
                    }
                    categoryExpenses[transaction.category] += transaction.amount;
                });
            
            // Prepare data for chart
            const labels = Object.keys(categoryExpenses);
            const data = Object.values(categoryExpenses);
            
            // Destroy existing chart if it exists
            if (categoryPieChart) {
                categoryPieChart.destroy();
            }
            
            // Create new chart
            categoryPieChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(153, 102, 255, 0.7)',
                            'rgba(255, 159, 64, 0.7)',
                            'rgba(199, 199, 199, 0.7)',
                            'rgba(83, 102, 255, 0.7)',
                            'rgba(40, 159, 64, 0.7)',
                            'rgba(210, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)',
                            'rgba(199, 199, 199, 1)',
                            'rgba(83, 102, 255, 1)',
                            'rgba(40, 159, 64, 1)',
                            'rgba(210, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ৳${value.toFixed(2)} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Update transaction history
        function updateTransactionHistory() {
            const tableBody = document.getElementById('transactionTableBody');
            
            if (transactions.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="5" class="px-6 py-4 text-center text-gray-500">No transactions found</td></tr>';
                return;
            }
            
            // Sort transactions by date (newest first)
            const sortedTransactions = [...transactions].sort((a, b) => {
                return new Date(b.date) - new Date(a.date);
            });
            
            // Build table rows
            tableBody.innerHTML = '';
            sortedTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                
                // Format date
                const date = new Date(transaction.date);
                const formattedDate = date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                
                // Determine type color and icon
                let typeColor, typeIcon, typeText;
                if (transaction.type === 'income') {
                    typeColor = 'text-green-600';
                    typeIcon = 'fa-arrow-down';
                    typeText = 'Income';
                } else {
                    typeColor = 'text-red-600';
                    typeIcon = 'fa-arrow-up';
                    typeText = 'Expense';
                }
                
                // Format category with icon if available
                let categoryDisplay = transaction.category;
                const config = categoryConfig[transaction.category];
                if (config) {
                    categoryDisplay = `<i class="fas ${config.icon} mr-1"></i> ${transaction.category}`;
                }
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">${formattedDate}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="${typeColor} font-medium">
                            <i class="fas ${typeIcon} mr-1"></i>
                            ${typeText}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">${categoryDisplay}</td>
                    <td class="px-6 py-4 whitespace-nowrap ${typeColor} font-medium">৳${transaction.amount.toFixed(2)}</td>
                    <td class="px-6 py-4">${transaction.notes || '-'}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Update assets list
        function updateAssetsList() {
            const assetsList = document.getElementById('assetsList');
            
            if (assets.length === 0) {
                assetsList.innerHTML = '<p class="text-gray-500 text-center py-4">No assets found</p>';
                return;
            }
            
            // Calculate totals
            const totalLent = assets.reduce((sum, asset) => sum + asset.amount, 0);
            const totalReceived = assets.reduce((sum, asset) => {
                return sum + asset.repayments.reduce((repSum, repayment) => repSum + repayment.amount, 0);
            }, 0);
            const totalAssetsAmount = totalLent - totalReceived;
            
            // Update totals
            document.getElementById('totalAssetsAmount').textContent = `৳${totalAssetsAmount.toFixed(2)}`;
            document.getElementById('totalLent').textContent = `৳${totalLent.toFixed(2)}`;
            document.getElementById('totalReceived').textContent = `৳${totalReceived.toFixed(2)}`;
            
            // Build assets list
            assetsList.innerHTML = '';
            assets.forEach(asset => {
                const totalRepaid = asset.repayments.reduce((sum, repayment) => sum + repayment.amount, 0);
                const remainingAmount = asset.amount - totalRepaid;
                
                const assetItem = document.createElement('div');
                assetItem.className = 'transaction-item';
                
                // Format date
                const date = new Date(asset.dateGiven);
                const formattedDate = date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                
                assetItem.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h3 class="font-semibold text-purple-600">${asset.borrowerName}</h3>
                            <p class="text-sm text-gray-500">${formattedDate}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-semibold">৳${asset.amount.toFixed(2)}</p>
                            <p class="text-sm text-gray-500">Lent</p>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="flex justify-between text-sm mb-1">
                            <span>Total Repaid:</span>
                            <span>৳${totalRepaid.toFixed(2)}</span>
                        </div>
                        <div class="flex justify-between text-sm font-semibold">
                            <span>Remaining:</span>
                            <span class="${remainingAmount > 0 ? 'text-purple-600' : 'text-green-600'}">৳${remainingAmount.toFixed(2)}</span>
                        </div>
                    </div>
                    
                    ${asset.notes ? `<p class="text-sm text-gray-600 mb-4">${asset.notes}</p>` : ''}
                    
                    <div class="flex justify-between">
                        <button class="text-sm text-purple-600 hover:text-purple-800 font-medium" onclick="openRepaymentModal(${asset.id})">
                            <i class="fas fa-plus-circle mr-1"></i>Add Repayment
                        </button>
                        <button class="text-sm text-red-600 hover:text-red-800 font-medium" onclick="deleteAsset(${asset.id})">
                            <i class="fas fa-trash-alt mr-1"></i>Delete
                        </button>
                    </div>
                    
                    ${asset.repayments.length > 0 ? `
                        <div class="mt-4 pt-4 border-t border-gray-200">
                            <h4 class="text-sm font-semibold text-gray-700 mb-2">Repayments:</h4>
                            <div class="space-y-2">
                                ${asset.repayments.map(repayment => {
                                    const repaymentDate = new Date(repayment.dateReceived);
                                    const formattedRepaymentDate = repaymentDate.toLocaleDateString('en-US', {
                                        year: 'numeric',
                                        month: 'short',
                                        day: 'numeric'
                                    });
                                    
                                    return `
                                        <div class="flex justify-between text-sm">
                                            <span>${formattedRepaymentDate}</span>
                                            <span class="font-medium">৳${repayment.amount.toFixed(2)}</span>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    ` : ''}
                `;
                
                assetsList.appendChild(assetItem);
            });
        }
        
        // Update liabilities list
        function updateLiabilitiesList() {
            const liabilitiesList = document.getElementById('liabilitiesList');
            
            if (liabilities.length === 0) {
                liabilitiesList.innerHTML = '<p class="text-gray-500 text-center py-4">No liabilities found</p>';
                return;
            }
            
            // Calculate totals
            const totalBorrowed = liabilities.reduce((sum, liability) => sum + liability.amount, 0);
            const totalReturned = liabilities.reduce((sum, liability) => {
                return sum + liability.returns.reduce((retSum, ret) => retSum + ret.amount, 0);
            }, 0);
            const totalLiabilitiesAmount = totalBorrowed - totalReturned;
            
            // Update totals
            document.getElementById('totalLiabilitiesAmount').textContent = `৳${totalLiabilitiesAmount.toFixed(2)}`;
            document.getElementById('totalBorrowed').textContent = `৳${totalBorrowed.toFixed(2)}`;
            document.getElementById('totalReturned').textContent = `৳${totalReturned.toFixed(2)}`;
            
            // Build liabilities list
            liabilitiesList.innerHTML = '';
            liabilities.forEach(liability => {
                const totalReturned = liability.returns.reduce((sum, ret) => sum + ret.amount, 0);
                const remainingAmount = liability.amount - totalReturned;
                
                const liabilityItem = document.createElement('div');
                liabilityItem.className = 'transaction-item';
                
                // Format date
                const date = new Date(liability.dateTaken);
                const formattedDate = date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                
                liabilityItem.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h3 class="font-semibold text-orange-600">${liability.lenderName}</h3>
                            <p class="text-sm text-gray-500">${formattedDate}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-semibold">৳${liability.amount.toFixed(2)}</p>
                            <p class="text-sm text-gray-500">Borrowed</p>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="flex justify-between text-sm mb-1">
                            <span>Total Returned:</span>
                            <span>৳${totalReturned.toFixed(2)}</span>
                        </div>
                        <div class="flex justify-between text-sm font-semibold">
                            <span>Remaining:</span>
                            <span class="${remainingAmount > 0 ? 'text-orange-600' : 'text-green-600'}">৳${remainingAmount.toFixed(2)}</span>
                        </div>
                    </div>
                    
                    ${liability.notes ? `<p class="text-sm text-gray-600 mb-4">${liability.notes}</p>` : ''}
                    
                    <div class="flex justify-between">
                        <button class="text-sm text-orange-600 hover:text-orange-800 font-medium" onclick="openReturnModal(${liability.id})">
                            <i class="fas fa-plus-circle mr-1"></i>Add Return
                        </button>
                        <button class="text-sm text-red-600 hover:text-red-800 font-medium" onclick="deleteLiability(${liability.id})">
                            <i class="fas fa-trash-alt mr-1"></i>Delete
                        </button>
                    </div>
                    
                    ${liability.returns.length > 0 ? `
                        <div class="mt-4 pt-4 border-t border-gray-200">
                            <h4 class="text-sm font-semibold text-gray-700 mb-2">Returns:</h4>
                            <div class="space-y-2">
                                ${liability.returns.map(returnPayment => {
                                    const returnDate = new Date(returnPayment.dateReturned);
                                    const formattedReturnDate = returnDate.toLocaleDateString('en-US', {
                                        year: 'numeric',
                                        month: 'short',
                                        day: 'numeric'
                                    });
                                    
                                    return `
                                        <div class="flex justify-between text-sm">
                                            <span>${formattedReturnDate}</span>
                                            <span class="font-medium">৳${returnPayment.amount.toFixed(2)}</span>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    ` : ''}
                `;
                
                liabilitiesList.appendChild(liabilityItem);
            });
        }
        
        // Delete asset
        function deleteAsset(assetId) {
            if (confirm('Are you sure you want to delete this asset?')) {
                assets = assets.filter(asset => asset.id !== assetId);
                localStorage.setItem('assets', JSON.stringify(assets));
                
                updateDashboard();
                updateMonthlySummary();
                updateAssetsList();
                
                showToast('Asset deleted successfully!');
            }
        }
        
        // Delete liability
        function deleteLiability(liabilityId) {
            if (confirm('Are you sure you want to delete this liability?')) {
                liabilities = liabilities.filter(liability => liability.id !== liabilityId);
                localStorage.setItem('liabilities', JSON.stringify(liabilities));
                
                updateDashboard();
                updateMonthlySummary();
                updateLiabilitiesList();
                
                showToast('Liability deleted successfully!');
            }
        }
        
        // Apply filters
        function applyFilters() {
            const typeFilter = document.getElementById('filterType').value;
            const categoryFilter = document.getElementById('filterCategory').value;
            const startDateFilter = document.getElementById('filterStartDate').value;
            const endDateFilter = document.getElementById('filterEndDate').value;
            
            let filteredTransactions = [...transactions];
            
            // Apply type filter
            if (typeFilter) {
                filteredTransactions = filteredTransactions.filter(t => t.type === typeFilter);
            }
            
            // Apply category filter
            if (categoryFilter) {
                filteredTransactions = filteredTransactions.filter(t => t.category === categoryFilter);
            }
            
            // Apply date range filter
            if (startDateFilter) {
                filteredTransactions = filteredTransactions.filter(t => t.date >= startDateFilter);
            }
            
            if (endDateFilter) {
                filteredTransactions = filteredTransactions.filter(t => t.date <= endDateFilter);
            }
            
            // Update table with filtered transactions
            updateTransactionTable(filteredTransactions);
        }
        
        // Clear filters
        function clearFilters() {
            document.getElementById('filterType').value = '';
            document.getElementById('filterCategory').value = '';
            document.getElementById('filterStartDate').value = '';
            document.getElementById('filterEndDate').value = '';
            
            updateTransactionHistory();
        }
        
        // Update transaction table with given data
        function updateTransactionTable(transactionData) {
            const tableBody = document.getElementById('transactionTableBody');
            
            if (transactionData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="5" class="px-6 py-4 text-center text-gray-500">No transactions found</td></tr>';
                return;
            }
            
            // Build table rows
            tableBody.innerHTML = '';
            transactionData.forEach(transaction => {
                const row = document.createElement('tr');
                
                // Format date
                const date = new Date(transaction.date);
                const formattedDate = date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                
                // Determine type color and icon
                let typeColor, typeIcon, typeText;
                if (transaction.type === 'income') {
                    typeColor = 'text-green-600';
                    typeIcon = 'fa-arrow-down';
                    typeText = 'Income';
                } else {
                    typeColor = 'text-red-600';
                    typeIcon = 'fa-arrow-up';
                    typeText = 'Expense';
                }
                
                // Format category with icon if available
                let categoryDisplay = transaction.category;
                const config = categoryConfig[transaction.category];
                if (config) {
                    categoryDisplay = `<i class="fas ${config.icon} mr-1"></i> ${transaction.category}`;
                }
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">${formattedDate}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="${typeColor} font-medium">
                            <i class="fas ${typeIcon} mr-1"></i>
                            ${typeText}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">${categoryDisplay}</td>
                    <td class="px-6 py-4 whitespace-nowrap ${typeColor} font-medium">৳${transaction.amount.toFixed(2)}</td>
                    <td class="px-6 py-4">${transaction.notes || '-'}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Sort transactions
        function sortTransactions(field) {
            const currentOrder = sortOrder[field];
            const newOrder = currentOrder === 'asc' ? 'desc' : 'asc';
            sortOrder[field] = newOrder;
            
            let sortedTransactions = [...transactions];
            
            if (field === 'date') {
                sortedTransactions.sort((a, b) => {
                    const dateA = new Date(a.date);
                    const dateB = new Date(b.date);
                    return newOrder === 'asc' ? dateA - dateB : dateB - dateA;
                });
            } else if (field === 'amount') {
                sortedTransactions.sort((a, b) => {
                    return newOrder === 'asc' ? a.amount - b.amount : b.amount - a.amount;
                });
            }
            
            updateTransactionTable(sortedTransactions);
            
            // Update sort icon
            const sortIcon = document.querySelector(`#sort${field.charAt(0).toUpperCase() + field.slice(1)} i`);
            sortIcon.className = `fas fa-sort-${newOrder === 'asc' ? 'up' : 'down'}`;
        }
        
        // Export to CSV
        function exportToCsv() {
            if (transactions.length === 0) {
                showToast('No transactions to export!', 'error');
                return;
            }
            
            let csv = 'Date,Type,Category,Amount,Notes\n';
            
            transactions.forEach(transaction => {
                const date = new Date(transaction.date).toLocaleDateString();
                const type = transaction.type;
                const category = transaction.category;
                const amount = transaction.amount;
                const notes = transaction.notes || '';
                
                csv += `"${date}","${type}","${category}","${amount}","${notes}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `expense_tracker_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('CSV exported successfully!');
        }
        
        // Export to PDF
        function exportToPdf() {
            if (transactions.length === 0) {
                showToast('No transactions to export!', 'error');
                return;
            }
            
            // Create a new jsPDF instance
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add title to the PDF
            doc.setFontSize(18);
            doc.text('Personal Expense Tracker - Transaction Report', 105, 15, { align: 'center' });
            
            // Add date range
            const today = new Date();
            const formattedDate = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            doc.setFontSize(12);
            doc.text(`Generated on: ${formattedDate}`, 105, 25, { align: 'center' });
            
            // Prepare data for the table
            const tableData = [];
            transactions.forEach(transaction => {
                const date = new Date(transaction.date).toLocaleDateString();
                const type = transaction.type;
                const category = transaction.category;
                const amount = `৳${transaction.amount.toFixed(2)}`;
                const notes = transaction.notes || '-';
                
                tableData.push([date, type, category, amount, notes]);
            });
            
            // Add table to PDF
            doc.autoTable({
                head: [['Date', 'Type', 'Category', 'Amount', 'Notes']],
                body: tableData,
                startY: 35,
                theme: 'grid',
                styles: {
                    fontSize: 10,
                    cellPadding: 3
                },
                headStyles: {
                    fillColor: [99, 102, 241],
                    textColor: 255
                },
                alternateRowStyles: {
                    fillColor: [245, 245, 245]
                }
            });
            
            // Save the PDF
            doc.save(`expense_tracker_${new Date().toISOString().split('T')[0]}.pdf`);
            
            showToast('PDF exported successfully!');
        }
        
        // Switch tab
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.remove('hidden');
            
            // Add active class to selected tab button
            const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
            activeBtn.classList.add('active');
            
            // Update specific tab content if needed
            if (tabName === 'assets-liabilities') {
                updateAssetsList();
                updateLiabilitiesList();
            }
        }
        
        // Toggle dark mode
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const darkModeIcon = document.querySelector('#darkModeToggle i');
            
            if (document.body.classList.contains('dark-mode')) {
                darkModeIcon.classList.remove('fa-moon');
                darkModeIcon.classList.add('fa-sun');
                localStorage.setItem('darkMode', 'true');
            } else {
                darkModeIcon.classList.remove('fa-sun');
                darkModeIcon.classList.add('fa-moon');
                localStorage.setItem('darkMode', 'false');
            }
        }
        
        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            // Set message
            toastMessage.textContent = message;
            
            // Remove existing classes
            toast.classList.remove('success', 'error', 'info');
            
            // Set appropriate class based on type
            if (type === 'success') {
                toast.classList.add('success');
            } else if (type === 'error') {
                toast.classList.add('error');
            } else if (type === 'info') {
                toast.classList.add('info');
            }
            
            // Show toast
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            // Hide toast after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            const darkModeIcon = document.querySelector('#darkModeToggle i');
            darkModeIcon.classList.remove('fa-moon');
            darkModeIcon.classList.add('fa-sun');
        }
    </script>
<script>
// Register Service Worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js')
      .then(registration => console.log('Service Worker registered'))
      .catch(error => console.log('Registration failed:', error));
  });
}
</script>


</body>
</html>